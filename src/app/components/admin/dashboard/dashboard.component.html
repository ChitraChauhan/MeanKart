<div class="admin-dashboard">

  <h3>User Management</h3>

  @if (loading) {
    <div class="loading">Loading users...</div>
  }

  @if (!loading && users.length === 0) {
    <div class="no-data">No users found.</div>
  }

  @if (!loading && users.length > 0) {
    <table class="users-table">
      <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Admin</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
        @for (user of users; track user._id) {
          <tr>
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>
              <input
                type="checkbox"
                [checked]="user.isAdmin"
                (change)="toggleUserStatus(user)"
              />
            </td>
            <td>
              <span [class.active]="isUserActive(user)" [class.inactive]="!isUserActive(user)">
                {{ isUserActive(user) ? 'Active' : 'Inactive' }}
                @if (!isUserActive(user) && user.lastActive) {
                  <span class="last-active">
                  (Last active: {{ getLastActiveTime(user.lastActive) }})
                </span>
                }
              </span>
            </td>
            <td>
              <button
                class="btn btn-danger"
                (click)="deleteUser(user._id)"
              >
                Delete
              </button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  }
</div>
